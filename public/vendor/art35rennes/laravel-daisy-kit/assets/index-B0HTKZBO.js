import{o as J}from"./app-Il9r1z46.js";const L={view:"month",views:["year","month","week","day","list"],initialDate:null,firstDay:1,hourStart:6,hourEnd:22,height:"auto",detail:"modal"};function K(t){let e={};try{e=JSON.parse(t.getAttribute("data-options")||"{}")||{}}catch{}const n={...L,...e};return(!Array.isArray(n.views)||!n.views.length)&&(n.views=L.views.slice()),n.firstDay=$(n.firstDay,0,6,L.firstDay),n.hourStart=$(n.hourStart,0,23,L.hourStart),n.hourEnd=$(n.hourEnd,n.hourStart+1,24,L.hourEnd),typeof n.height!="string"&&(n.height=String(n.height)),["modal","none"].includes(n.detail)||(n.detail=L.detail),n}function $(t,e,n,a){const o=Number(t);return Number.isFinite(o)?Math.min(n,Math.max(e,Math.trunc(o))):a}function z(t){const n=(Array.isArray(t)?t.slice():[]).map(a=>R(a));return{async loadRange(a,o){return n.filter(c=>x(c,a,o)).map(c=>({...c}))}}}function G(t){let e=null;const n=new Map;return{async loadRange(a,o){const i=`${S(a)}|${S(o)}`;if(n.has(i))return n.get(i).map(u=>({...u}));e&&e.abort(),e=new AbortController;const c=new URL(t,window.location.origin);c.searchParams.set("start",S(a)),c.searchParams.set("end",S(o));const s=await fetch(c,{signal:e.signal,headers:{Accept:"application/json"}});if(!s.ok)throw new Error(`HTTP ${s.status}`);const p=await s.json(),f=Array.isArray(p)?p.map(u=>R(u)):[];return n.set(i,f),f.map(u=>({...u}))}}}function R(t){const e=N(t.start),n=t.end?N(t.end):null;return{id:t.id??null,title:t.title??"",start:e,end:n,allDay:!!t.allDay,url:t.url||null,color:t.color||null,data:t.data||null,raw:t}}function x(t,e,n){const a=t.start,o=t.end||t.start;return a<n&&o>=e}function S(t){return t.toISOString().slice(0,10)}function N(t){return t instanceof Date?t:new Date(t)}function B(t,e){const{currentDate:n,events:a,firstDay:o}=e,i=n.getFullYear(),c=n.getMonth(),s=Y(i,c,o),p=b(s,42),f=[];for(let r=new Date(s);r<p;r=b(r,1))f.push(new Date(r));const u=document.createDocumentFragment(),g=m("div","cf-grid cf-month");u.appendChild(E()),u.appendChild(g);const l=S(new Date);return f.forEach((r,w)=>{const d=m("div","cf-cell");S(r)===l&&d.classList.add("is-today");const v=m("div","cf-date");v.textContent=String(r.getDate()),d.appendChild(v);const y=a.filter(h=>W(h,r));let D=0;const C=3;for(const h of y){if(D>=C)break;d.appendChild(nt(h,e)),D++}if(y.length>D){const h=m("a","cf-more link");h.textContent=`+${y.length-D} more`,h.href="#",h.addEventListener("click",k=>{k.preventDefault(),e.onMore(r,y)}),d.appendChild(h)}g.appendChild(d)}),t.innerHTML="",t.appendChild(u),{title:q(i,c),cleanup(){}}}function I(t,e){const{currentDate:n,events:a,hourStart:o,hourEnd:i,firstDay:c}=e,s=_(n,c);b(s,7);const p=document.createDocumentFragment();p.appendChild(E());const f=m("div","cf-grid cf-week");p.appendChild(f);const u=m("div");u.style.display="grid",u.style.gridTemplateRows=`repeat(${i-o}, 3rem)`;for(let g=o;g<i;g++){const l=m("div","cf-hour");l.textContent=`${g}:00`,u.appendChild(l)}f.appendChild(u);for(let g=0;g<7;g++){const l=m("div");l.style.position="relative",l.style.display="grid",l.style.gridTemplateRows=`repeat(${i-o}, 3rem)`;const r=b(s,g),w=a.filter(d=>d.allDay?W(d,r):x(d,r,b(r,1)));for(let d=o;d<i;d++)l.appendChild(m("div","cf-slot"));for(const d of w){if(d.allDay)continue;const v=F(tt(d.start,r))-o,y=F(et(d.end||d.start,b(r,1)))-o,D=m("div","cf-block");D.style.top=`${v*3}rem`,D.style.height=`${Math.max(.8,y-v)*3}rem`,d.color&&(D.style.background=d.color);const C=A("block"),h={title:d.title||"(untitled)",timeRange:U(d.start,d.end)};D.appendChild(H(C,h)),D.addEventListener("click",()=>e.onEventClick(d)),l.appendChild(D)}f.appendChild(l)}return t.innerHTML="",t.appendChild(p),{title:P(s),cleanup(){}}}function V(t,e){const n={...e},a=m("div");t.innerHTML="",t.appendChild(a);const{title:o,cleanup:i}=I(a,{...n,currentDate:n.currentDate});return{title:Z(n.currentDate),cleanup:i}}function Q(t,e){const{currentDate:n,events:a}=e,o=_(n,e.firstDay),i=b(o,7),c=m("div","cf-list"),s=document.createDocumentFragment();s.appendChild(E());const p=a.filter(f=>x(f,o,i)).sort((f,u)=>f.start-u.start);if(p.length)for(const f of p){const u=m("div","cf-li"),g=A("list"),l={title:f.title||"(untitled)",timeRange:U(f.start,f.end)};u.appendChild(H(g,l)),u.addEventListener("click",()=>e.onEventClick(f)),c.appendChild(u)}else{const f=m("p","opacity-70");f.textContent="No events",c.appendChild(f)}return s.appendChild(c),t.innerHTML="",t.appendChild(s),{title:P(o),cleanup(){}}}function X(t,e){const{currentDate:n,firstDay:a}=e,o=n.getFullYear(),i=document.createDocumentFragment();i.appendChild(E());const c=m("div","cf-grid");c.style.display="grid",c.style.gridTemplateColumns="repeat(4, minmax(0, 1fr))",c.style.gap=".75rem";for(let s=0;s<12;s++){const p=m("div"),f=m("div","text-center font-medium mb-1");f.textContent=q(o,s);const u=m("div","cf-grid cf-month"),g=Y(o,s,a),l=b(g,42);for(let r=new Date(g);r<l;r=b(r,1)){const w=m("div","cf-cell"),d=m("div","cf-date");d.textContent=String(r.getDate()),w.appendChild(d),u.appendChild(w)}p.appendChild(f),p.appendChild(u),c.appendChild(p)}return t.innerHTML="",i.appendChild(c),t.appendChild(i),{title:String(o),cleanup(){}}}function m(t,e){const n=document.createElement(t);return e&&(n.className=e),n}function b(t,e){const n=new Date(t);return n.setDate(n.getDate()+e),n}function Y(t,e,n){const a=new Date(t,e,1),i=(a.getDay()-n+7)%7;return a.setDate(a.getDate()-i),a}function _(t,e){const n=new Date(t),o=(n.getDay()-e+7)%7;return n.setDate(n.getDate()-o),n}function q(t,e){return new Date(t,e,1).toLocaleDateString(void 0,{month:"long",year:"numeric"})}function Z(t){return t.toLocaleDateString(void 0,{dateStyle:"full"})}function P(t){const e=b(t,6),n={month:"short",day:"numeric"};return`${t.toLocaleDateString(void 0,n)} – ${e.toLocaleDateString(void 0,n)}, ${t.getFullYear()}`}function F(t){return t.getHours()+t.getMinutes()/60}function tt(t,e){return t>e?t:e}function et(t,e){return t<e?t:e}function U(t,e){const n=!e||t.toDateString()===e.toDateString(),a=t.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"}),o=t.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"});if(!e)return`${a} ${o}`;const i=e.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"});return n?`${a} ${o} – ${i}`:`${a} ${o} → ${e.toLocaleDateString(void 0,{month:"short",day:"numeric"})} ${i}`}function W(t,e){const n=new Date(e),a=b(e,1),o=t.start,i=t.end||t.start;return o<a&&i>=n}function nt(t,e){const n=m("a","cf-event");t.color&&(n.style.background=t.color),n.href=t.url||"#";const a=A("chip"),o={title:t.title||"(untitled)",dotColor:t.color||"currentColor"};return n.appendChild(H(a,o)),n.addEventListener("click",i=>{t.url||i.preventDefault(),e.onEventClick(t)}),n}function A(t){const e=`template[data-calendar-event="${t}"]`;return document.querySelector(e)}function H(t,e){const n=m("span");if(!t)return n.textContent=e.title||"",n;const a=t.content.cloneNode(!0),o=ot(a).replace(/\{\{(\w+)\}\}/g,(i,c)=>c in e?String(e[c]):"");return n.innerHTML=o,n.firstElementChild?n.firstElementChild:n}function ot(t){const e=document.createElement("div");return e.appendChild(t),e.innerHTML}function E(t){const e=m("div");return e.className="cf-toolbar-space",e}const M=new WeakMap;function at(){document.querySelectorAll('[data-calendar-full="1"]').forEach(t=>rt(t))}function rt(t){if(M.has(t))return M.get(t);const e=K(t),n=st(t.getAttribute("data-events"))||null,a=t.getAttribute("data-events-url"),o=a?G(a):z(n||[]),i={options:e,source:o,currentDate:e.initialDate?new Date(e.initialDate):new Date,view:e.view,destroy:()=>{}},c=it(t,i);return M.set(t,c),c.render(),c}function it(t,e){const n=document.createElement("div");n.className="cf-toolbar";const a=document.createElement("div");a.className="font-medium";const o=document.createElement("div");o.className="btn-group";const i=document.createElement("div");i.className="btn-group",n.appendChild(o),n.appendChild(a),n.appendChild(i);function c(){o.innerHTML="",i.innerHTML="";const l=s("«");l.addEventListener("click",()=>f(-1));const r=p(dt("today"));r.addEventListener("click",()=>{e.currentDate=new Date,u()});const w=s("»");w.addEventListener("click",()=>f(1)),o.appendChild(l),o.appendChild(r),o.appendChild(w),e.options.views.forEach(v=>{const y=p(lt(v));v===e.view?y.classList.add("btn-primary"):y.classList.add("btn-outline"),y.addEventListener("click",()=>{e.view=v,u()}),i.appendChild(y)})}function s(l){const r=document.createElement("button");return r.className="btn btn-sm",r.textContent=l,r}function p(l){const r=document.createElement("button");return r.className="btn btn-sm",r.textContent=l,r}function f(l){const r=new Date(e.currentDate);switch(e.view){case"day":r.setDate(r.getDate()+l);break;case"week":r.setDate(r.getDate()+7*l);break;case"year":r.setFullYear(r.getFullYear()+l);break;case"list":r.setDate(r.getDate()+7*l);break;default:r.setMonth(r.getMonth()+l);break}e.currentDate=r,u()}async function u(){const{start:l,end:r}=ct(e.view,e.currentDate,e.options);await new Promise(h=>J(h));let w=[];try{w=await e.source.loadRange(l,r)}catch{w=[]}t.style.minHeight=e.options.height==="auto"?"":`${parseInt(e.options.height,10)||600}px`;const d=document.createElement("div");function v(h){e.options.detail==="modal"&&j(h),t.dispatchEvent(new CustomEvent("calendar:detail",{detail:h}))}function y(h,k){mt(h,k)}const D={...e.options,currentDate:e.currentDate,events:w,onEventClick:v,onMore:y};let C={title:""};switch(e.view){case"week":C=I(d,D);break;case"day":C=V(d,D);break;case"list":C=Q(d,D);break;case"year":C=X(d,D);break;default:C=B(d,D);break}c(),a.textContent=C.title,t.innerHTML="",t.appendChild(n),t.appendChild(d)}function g(){t.innerHTML=""}return{render:u,destroy:g}}function ct(t,e,n){const a=new Date(e);if(t==="day"){const c=ft(a),s=O(c,1);return{start:c,end:s}}if(t==="week"||t==="list"){const c=ut(a,n.firstDay),s=O(c,7);return{start:c,end:s}}if(t==="year"){const c=new Date(a.getFullYear(),0,1),s=new Date(a.getFullYear()+1,0,1);return{start:c,end:s}}const o=new Date(a.getFullYear(),a.getMonth(),1),i=new Date(a.getFullYear(),a.getMonth()+1,1);return{start:o,end:i}}function st(t){try{return JSON.parse(t||"")}catch{return null}}function dt(t){try{return window.daisyI18n&&window.daisyI18n.calendar&&window.daisyI18n.calendar[t]||t}catch{return t}}function lt(t){return String(t).charAt(0).toUpperCase()+String(t).slice(1)}function ut(t,e){const n=new Date(t),o=(n.getDay()-e+7)%7;return n.setDate(n.getDate()-o),n}function ft(t){const e=new Date(t);return e.setHours(0,0,0,0),e}function O(t,e){const n=new Date(t);return n.setDate(n.getDate()+e),n}function j(t){const e=document.createElement("dialog");e.className="modal modal-middle",e.innerHTML=`
    <div class="modal-box">
      <h3 class="text-lg font-bold mb-2">${T(t.title||"Event")}</h3>
      <div class="mb-4 text-sm opacity-80">${pt(t.start,t.end,t.allDay)}</div>
      <div class="mb-2">${t.raw?.description?T(t.raw.description):""}</div>
      <div class="modal-action">
        <form method="dialog"><button class="btn">OK</button></form>
      </div>
    </div>
    <form method="dialog" class="modal-backdrop"><button>close</button></form>`,document.body.appendChild(e);try{e.showModal()}catch{e.setAttribute("open","")}e.addEventListener("close",()=>e.remove())}function mt(t,e){const n=document.createElement("dialog");n.className="modal modal-middle";const a=e.map(o=>`<li class="py-1"><a class="link" href="#" data-id="${o.id||""}">${T(o.title||"(untitled)")}</a></li>`).join("");n.innerHTML=`
    <div class="modal-box">
      <h3 class="text-lg font-bold mb-2">${t.toLocaleDateString(void 0,{dateStyle:"full"})}</h3>
      <ul class="mb-4">${a||'<li class="opacity-70">No events</li>'}</ul>
      <div class="modal-action"><form method="dialog"><button class="btn">OK</button></form></div>
    </div>
    <form method="dialog" class="modal-backdrop"><button>close</button></form>`,document.body.appendChild(n),n.addEventListener("click",o=>{const i=o.target.closest("a[data-id]");if(!i)return;o.preventDefault();const c=i.getAttribute("data-id"),s=e.find(p=>String(p.id||"")===c);s&&j(s)});try{n.showModal()}catch{n.setAttribute("open","")}n.addEventListener("close",()=>n.remove())}function T(t){return String(t||"").replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[e])}function pt(t,e,n){if(n){const c=t.toLocaleDateString(void 0,{dateStyle:"medium"}),s=e?e.toLocaleDateString(void 0,{dateStyle:"medium"}):null;return s?`${c} → ${s}`:c}const a=`${t.toLocaleDateString(void 0,{month:"short",day:"numeric"})} ${t.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})}`;if(!e)return a;const i=t.toDateString()===e.toDateString()?e.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"}):`${e.toLocaleDateString(void 0,{month:"short",day:"numeric"})} ${e.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})}`;return`${a} – ${i}`}function ht(t){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t()}ht(()=>{try{at()}catch{}});export{at as mountAllCalendars};
